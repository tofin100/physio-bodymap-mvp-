<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kintaro ‚Ä¢ BodyMap MVP (Front) ‚Äî Silhouette + Voice</title>

  <style>
    :root{
      --bg:#050814;
      --line:rgba(255,255,255,.10);
      --text:#EAF0FF;
      --muted:#AAB3CF;
      --gold:#E6C15A;
      --cyan:#52E6FF;
      --danger:#FF5C7A;
      --shadow: 0 14px 50px rgba(0,0,0,.55);

      /* active fill (updated by intensity slider) */
      --fill: rgba(230,193,90,.55);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--text);
      background:
        radial-gradient(1000px 650px at 18% 10%, rgba(82,230,255,.12), transparent 55%),
        radial-gradient(900px 600px at 80% 20%, rgba(230,193,90,.10), transparent 55%),
        linear-gradient(180deg, #030513, var(--bg));
      min-height:100vh;
    }

    /* top */
    .topbar{
      max-width:1100px;margin:0 auto;
      padding:16px 16px 10px;
      display:flex;align-items:center;justify-content:space-between;gap:12px;
    }
    .brand{display:flex;align-items:center;gap:12px}
    .logo{
      width:34px;height:34px;border-radius:12px;
      background:
        radial-gradient(12px 12px at 30% 30%, rgba(255,255,255,.35), transparent 60%),
        linear-gradient(135deg, rgba(82,230,255,.35), rgba(230,193,90,.22));
      border:1px solid rgba(255,255,255,.14);
      box-shadow: 0 0 22px rgba(82,230,255,.12);
    }
    .title{
      font-weight:860;letter-spacing:.25px;font-size:16px;
      background: linear-gradient(90deg, var(--gold), #fff, var(--cyan));
      -webkit-background-clip:text;background-clip:text;color:transparent;
    }
    .subtitle{font-size:12.5px;color:var(--muted);margin-top:2px}

    /* layout */
    .shell{
      max-width:1100px;margin:0 auto;
      padding:10px 16px 24px;
      display:grid;grid-template-columns: 360px 1fr;
      gap:14px;
    }
    .card{
      border-radius:16px;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .cardHead{
      padding:12px 12px 10px;
      border-bottom:1px solid rgba(255,255,255,.08);
      background: linear-gradient(180deg, rgba(82,230,255,.06), rgba(230,193,90,.04));
      display:flex;align-items:center;justify-content:space-between;gap:10px;
    }
    .cardTitle{font-weight:820;font-size:13px}
    .cardBody{padding:12px}

    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .field{display:flex;flex-direction:column;gap:7px;flex:1}
    label{font-size:12px;color:var(--muted)}
    input[type="range"]{width:100%}

    .btn{
      border:none;cursor:pointer;
      padding:10px 10px;border-radius:12px;
      font-weight:780;font-size:12.5px;
      color:var(--text);
      background: rgba(82,230,255,.13);
      border:1px solid rgba(82,230,255,.24);
      transition: transform .05s ease, background .15s ease, border .15s ease;
      user-select:none;
    }
    .btn:hover{background: rgba(82,230,255,.17); border-color: rgba(82,230,255,.34)}
    .btn:active{transform: translateY(1px)}
    .btn.ghost{
      background: rgba(0,0,0,.22);
      border-color: rgba(255,255,255,.14);
    }
    .btn.danger{
      background: rgba(255,92,122,.14);
      border-color: rgba(255,92,122,.28);
    }
    .btn.small{padding:7px 9px;font-size:12px}

    .chip{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 10px;border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.20);
      color: rgba(255,255,255,.88);
      font-size:12px;
    }
    .dot{
      width:10px;height:10px;border-radius:999px;
      background: var(--cyan);
      box-shadow: 0 0 18px rgba(82,230,255,.35);
    }
    .dot.off{background: rgba(255,255,255,.18); box-shadow:none}

    .hint{font-size:12px;color:var(--muted);line-height:1.35;margin-top:8px}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
    .kbd{
      font-size:11px;
      padding:2px 6px;
      border:1px solid rgba(255,255,255,.14);
      border-radius:6px;
      background: rgba(0,0,0,.18);
      color: rgba(255,255,255,.88);
    }

    /* stage */
    .stage{
      position:relative;
      min-height: 780px;
      padding:12px;
      background:
        radial-gradient(360px 260px at 50% 18%, rgba(255,255,255,.05), transparent 65%),
        linear-gradient(180deg, rgba(0,0,0,.10), rgba(0,0,0,.22));
    }
    .stageInner{
      position:absolute; inset:12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.10);
      display:flex;align-items:center;justify-content:center;
      overflow:hidden;
    }
    svg{width:100%;height:100%;display:block}

    /* silhouette + regions */
    .base{
      fill: rgba(255,255,255,0.06);
      stroke: rgba(255,255,255,0.16);
      stroke-width:2.2;
      stroke-linejoin:round;
      stroke-linecap:round;
    }
    .region{
      fill: rgba(0,0,0,0);
      stroke: rgba(255,255,255,0.08);
      stroke-width:1.4;
      stroke-linejoin:round;
      stroke-linecap:round;
      cursor:pointer;
      transition: fill .18s ease, filter .18s ease, opacity .18s ease;
    }
    .region:hover{filter: drop-shadow(0 0 10px rgba(82,230,255,.20))}
    .region.active{
      fill: var(--fill);
      filter: drop-shadow(0 0 12px rgba(230,193,90,.28));
    }
    .region.dim{opacity:.15}

    .status{
      padding:10px;border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.22);
      font-size:12.5px;color: rgba(255,255,255,.88);
      line-height:1.35;
      word-break: break-word;
    }

    @media (max-width: 980px){
      .shell{grid-template-columns:1fr}
      .stage{min-height: 680px}
    }
  </style>
</head>

<body>
<header class="topbar">
  <div class="brand">
    <div class="logo" aria-hidden="true"></div>
    <div>
      <div class="title">Kintaro ‚Ä¢ BodyMap MVP</div>
      <div class="subtitle">Front Silhouette ‚Ä¢ Klick ‚Ä¢ Voice Agent mit Wakeword <span class="mono">‚ÄûAnzeige‚Äú</span></div>
    </div>
  </div>

  <div class="chip" id="chipMic">
    <span class="dot off" id="micDot"></span>
    <span id="micLabel">Mic: Aus</span>
  </div>
</header>

<main class="shell">
  <!-- Controls -->
  <aside class="card">
    <div class="cardHead">
      <div class="cardTitle">Controls</div>
      <button class="btn danger small" id="btnReset">Reset</button>
    </div>

    <div class="cardBody">
      <div class="row" style="margin-bottom:10px;">
        <button class="btn" id="btnMic">üéôÔ∏è Start Listening</button>
        <button class="btn ghost" id="btnStop">Stop</button>
      </div>

      <div class="field">
        <label>Intensit√§t</label>
        <input type="range" min="1" max="10" value="6" id="rngIntensity" />
        <div class="hint">Steuert die Deckkraft der Einf√§rbung.</div>
      </div>

      <div class="hint" style="margin-top:12px">
        <b>Kommandos:</b><br>
        <span class="mono">Anzeige Kopf</span> ‚Ä¢ <span class="mono">Anzeige Hand rechts</span> ‚Ä¢ <span class="mono">Anzeige Bein</span><br>
        <span class="mono">Reset</span> ‚Ä¢ <span class="mono">Alles aus</span> ‚Ä¢ <span class="mono">Intensit√§t 8</span>
      </div>

      <div class="hint" style="margin-top:10px">
        Klick geht immer. Voice reagiert nur, wenn das Wakeword <span class="mono">Anzeige</span> drin ist.
      </div>

      <div style="margin-top:12px" class="status" id="status">
        Status: Bereit.
        <div class="hint" style="margin-top:8px">
          Shortcuts: <span class="kbd">Esc</span> Reset ‚Ä¢ <span class="kbd">Space</span> Mic an/aus
        </div>
      </div>
    </div>
  </aside>

  <!-- Stage -->
  <section class="card">
    <div class="cardHead">
      <div class="cardTitle">Silhouette ‚Ä¢ Front</div>
      <div class="row">
        <span class="chip"><span class="dot"></span><span>Click-to-highlight</span></span>
      </div>
    </div>

    <div class="stage">
      <div class="stageInner">
        <!-- Inline SVG: reliable click + voice mapping -->
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 1000" role="img" aria-label="Human silhouette front with regions">
          <defs>
            <filter id="softEdge" x="-20%" y="-20%" width="140%" height="140%">
              <feGaussianBlur stdDeviation="1.2" result="b"/>
              <feColorMatrix in="b" type="matrix"
                values="1 0 0 0 0
                        0 1 0 0 0
                        0 0 1 0 0
                        0 0 0 .18 0" result="g"/>
              <feMerge>
                <feMergeNode in="g"/>
                <feMergeNode in="SourceGraphic"/>
              </feMerge>
            </filter>
          </defs>

          <g id="bodymap-front" filter="url(#softEdge)">
            <!-- Base (non-clickable) -->
            <path class="base"
              d="M300 72
                 C268 72 247 92 244 121
                 C240 159 266 184 300 186
                 C334 184 360 159 356 121
                 C353 92 332 72 300 72
                 Z

                 M240 196
                 C220 210 210 235 211 265
                 C212 301 232 327 250 345
                 C244 360 240 378 240 400
                 C240 436 256 468 270 490
                 C260 505 254 522 252 548
                 C248 596 266 640 286 682
                 C294 699 296 715 292 730
                 C287 754 276 777 268 798
                 C262 814 262 832 274 846
                 C288 862 312 861 322 846
                 C330 835 330 819 324 802
                 C316 780 306 757 303 732
                 C301 718 304 701 312 682
                 C332 640 350 596 348 548
                 C347 522 340 505 330 490
                 C344 468 360 436 360 400
                 C360 378 356 360 350 345
                 C368 327 388 301 389 265
                 C390 235 380 210 360 196
                 C340 220 320 234 300 234
                 C280 234 260 220 240 196
                 Z

                 M210 280
                 C176 305 160 340 156 382
                 C152 430 168 474 198 508
                 C214 526 232 522 234 504
                 C238 470 238 438 236 404
                 C235 372 238 346 246 322
                 C252 304 236 268 210 280
                 Z

                 M390 280
                 C424 305 440 340 444 382
                 C448 430 432 474 402 508
                 C386 526 368 522 366 504
                 C362 470 362 438 364 404
                 C365 372 362 346 354 322
                 C348 304 364 268 390 280
                 Z"/>

            <!-- Regions (clickable) -->
            <g id="regions">
              <path id="head" class="region" data-keys="kopf head"
                d="M300 78 C274 78 256 97 254 122 C252 152 272 174 300 176 C328 174 348 152 346 122 C344 97 326 78 300 78 Z"/>

              <path id="neck" class="region" data-keys="hals neck"
                d="M282 176 C286 196 286 210 282 224 C292 236 308 236 318 224 C314 210 314 196 318 176 C310 184 290 184 282 176 Z"/>

              <path id="shoulders" class="region" data-keys="schultern shoulders"
                d="M240 196 C262 224 280 236 300 236 C320 236 338 224 360 196 C350 186 336 182 322 184 C314 196 306 202 300 202 C294 202 286 196 278 184 C264 182 250 186 240 196 Z"/>

              <path id="chest" class="region" data-keys="brust chest thorax"
                d="M258 236 C248 260 244 286 244 312 C244 342 254 370 270 388 C286 406 314 406 330 388 C346 370 356 342 356 312 C356 286 352 260 342 236 C326 252 314 260 300 260 C286 260 274 252 258 236 Z"/>

              <path id="abdomen" class="region" data-keys="bauch abdomen"
                d="M270 388 C258 408 252 432 252 456 C252 484 262 510 276 528 C288 544 312 544 324 528 C338 510 348 484 348 456 C348 432 342 408 330 388 C320 398 310 404 300 404 C290 404 280 398 270 388 Z"/>

              <path id="pelvis" class="region" data-keys="becken pelvis huefte h√ºfte"
                d="M276 528 C262 548 256 568 256 590 C256 622 268 652 286 678 C292 686 296 694 300 704 C304 694 308 686 314 678 C332 652 344 622 344 590 C344 568 338 548 324 528 C316 536 308 540 300 540 C292 540 284 536 276 528 Z"/>

              <path id="arm_upper_l" class="region" data-keys="oberarm links linker arm upper arm left"
                d="M238 238 C214 252 200 276 198 306 C196 336 204 362 216 382 C226 398 242 394 244 376 C248 344 252 316 260 290 C266 270 258 232 238 238 Z"/>
              <path id="arm_upper_r" class="region" data-keys="oberarm rechts rechter arm upper arm right"
                d="M362 238 C386 252 400 276 402 306 C404 336 396 362 384 382 C374 398 358 394 356 376 C352 344 348 316 340 290 C334 270 342 232 362 238 Z"/>

              <path id="forearm_l" class="region" data-keys="unterarm links linker unterarm forearm left"
                d="M212 382 C196 402 186 428 186 456 C186 484 196 506 210 520 C224 534 240 526 238 508 C236 478 236 452 240 426 C244 404 230 370 212 382 Z"/>
              <path id="forearm_r" class="region" data-keys="unterarm rechts rechter unterarm forearm right"
                d="M388 382 C404 402 414 428 414 456 C414 484 404 506 390 520 C376 534 360 526 362 508 C364 478 364 452 360 426 C356 404 370 370 388 382 Z"/>

              <path id="hand_l" class="region" data-keys="hand links linke hand left hand"
                d="M204 520 C188 532 186 554 200 570 C216 588 244 590 258 570 C270 554 264 532 246 520 C232 510 216 510 204 520 Z"/>
              <path id="hand_r" class="region" data-keys="hand rechts rechte hand right hand"
                d="M396 520 C412 532 414 554 400 570 C384 588 356 590 342 570 C330 554 336 532 354 520 C368 510 384 510 396 520 Z"/>

              <path id="thigh_l" class="region" data-keys="oberschenkel links thigh left"
                d="M286 678 C266 708 258 744 262 780 C266 812 280 838 292 862 C300 878 320 872 316 854 C306 812 302 774 304 736 C306 714 300 690 292 678 C290 680 288 679 286 678 Z"/>
              <path id="thigh_r" class="region" data-keys="oberschenkel rechts thigh right"
                d="M314 678 C334 708 342 744 338 780 C334 812 320 838 308 862 C300 878 280 872 284 854 C294 812 298 774 296 736 C294 714 300 690 308 678 C310 680 312 679 314 678 Z"/>

              <path id="knee_l" class="region" data-keys="knie links knee left"
                d="M270 804 C258 812 252 826 254 840 C256 856 270 866 286 864 C300 862 308 850 306 836 C304 822 286 798 270 804 Z"/>
              <path id="knee_r" class="region" data-keys="knie rechts knee right"
                d="M330 804 C342 812 348 826 346 840 C344 856 330 866 314 864 C300 862 292 850 294 836 C296 822 314 798 330 804 Z"/>

              <path id="calf_l" class="region" data-keys="wade links calf left"
                d="M268 846 C258 866 254 888 256 910 C258 936 268 960 282 980 C290 992 308 990 306 974 C304 952 302 930 304 908 C306 888 290 840 268 846 Z"/>
              <path id="calf_r" class="region" data-keys="wade rechts calf right"
                d="M332 846 C342 866 346 888 344 910 C342 936 332 960 318 980 C310 992 292 990 294 974 C296 952 298 930 296 908 C294 888 310 840 332 846 Z"/>

              <path id="foot_l" class="region" data-keys="fuss fu√ü links foot left"
                d="M270 980 C246 988 236 1006 248 1022 C262 1040 294 1040 316 1026 C334 1014 336 996 320 988 C304 980 288 978 270 980 Z"/>
              <path id="foot_r" class="region" data-keys="fuss fu√ü rechts foot right"
                d="M330 980 C354 988 364 1006 352 1022 C338 1040 306 1040 284 1026 C266 1014 264 996 280 988 C296 980 312 978 330 980 Z"/>
            </g>
          </g>
        </svg>
      </div>
    </div>
  </section>
</main>

<script>
  // ---------------------------
  // Helpers
  // ---------------------------
  const $ = (id) => document.getElementById(id);

  function normalize(s){
    return (s||"")
      .toLowerCase()
      .replace(/[√§]/g,"ae").replace(/[√∂]/g,"oe").replace(/[√º]/g,"ue").replace(/√ü/g,"ss")
      .replace(/[^a-z0-9\\s]/g," ")
      .replace(/\\s+/g," ")
      .trim();
  }
  function escapeHtml(s){
    return (s||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");
  }
  function setStatus(html){
    $("status").innerHTML = "Status: " + html;
  }

  // ---------------------------
  // Intensity ‚Üí CSS var
  // ---------------------------
  const rngIntensity = $("rngIntensity");
  function setFillByIntensity(n){
    const a = 0.18 + (n-1) * (0.62/9); // 0.18..0.80
    document.documentElement.style.setProperty("--fill", `rgba(230,193,90,${a.toFixed(3)})`);
  }
  setFillByIntensity(parseInt(rngIntensity.value,10));
  rngIntensity.addEventListener("input", (e)=>{
    setFillByIntensity(parseInt(e.target.value,10));
  });

  // ---------------------------
  // Click-to-highlight (toggle)
  // ---------------------------
  const svg = document.querySelector("svg");
  const regions = () => [...svg.querySelectorAll(".region")];

  function clearAll(){
    regions().forEach(r => r.classList.remove("active"));
  }

  function activate(id){
    const el = svg.getElementById(id);
    if (!el) return false;
    el.classList.add("active");
    return true;
  }

  function activateBoth(base){ // e.g. "hand" -> hand_l + hand_r if both exist
    const a = activate(base + "_l");
    const b = activate(base + "_r");
    return a || b;
  }

  svg.addEventListener("click", (e)=>{
    const el = e.target;
    if (!el.classList.contains("region")) return;
    el.classList.toggle("active");
    setStatus(`<b>${el.id}</b> ${el.classList.contains("active") ? "aktiviert" : "deaktiviert"}.`);
  });

  // ---------------------------
  // Voice Agent (Web Speech API)