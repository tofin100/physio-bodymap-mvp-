<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kintaro ‚Ä¢ BodyMap MVP ‚Äî 50 Muskeln (Latein) + Voice</title>

  <style>
    :root{
      --bg:#050814;
      --line:rgba(255,255,255,.10);
      --text:#EAF0FF;
      --muted:#AAB3CF;
      --gold:#E6C15A;
      --cyan:#52E6FF;
      --danger:#FF5C7A;
      --shadow: 0 14px 50px rgba(0,0,0,.55);
      --fill: rgba(230,193,90,.60);
      --fill2: rgba(82,230,255,.40);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--text);
      background:
        radial-gradient(1000px 650px at 18% 10%, rgba(82,230,255,.12), transparent 55%),
        radial-gradient(900px 600px at 80% 20%, rgba(230,193,90,.10), transparent 55%),
        linear-gradient(180deg, #030513, var(--bg));
      min-height:100vh;
    }
    .topbar{
      max-width:1100px;margin:0 auto;
      padding:16px 16px 10px;
      display:flex;align-items:center;justify-content:space-between;gap:12px;
    }
    .brand{display:flex;align-items:center;gap:12px}
    .logo{
      width:34px;height:34px;border-radius:12px;
      background:
        radial-gradient(12px 12px at 30% 30%, rgba(255,255,255,.35), transparent 60%),
        linear-gradient(135deg, rgba(82,230,255,.35), rgba(230,193,90,.22));
      border:1px solid rgba(255,255,255,.14);
      box-shadow: 0 0 22px rgba(82,230,255,.12);
    }
    .title{
      font-weight:860;letter-spacing:.25px;font-size:16px;
      background: linear-gradient(90deg, var(--gold), #fff, var(--cyan));
      -webkit-background-clip:text;background-clip:text;color:transparent;
    }
    .subtitle{font-size:12.5px;color:var(--muted);margin-top:2px}

    .shell{
      max-width:1100px;margin:0 auto;
      padding:10px 16px 24px;
      display:grid;grid-template-columns: 360px 1fr;
      gap:14px;
    }
    .card{
      border-radius:16px;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .cardHead{
      padding:12px 12px 10px;
      border-bottom:1px solid rgba(255,255,255,.08);
      background: linear-gradient(180deg, rgba(82,230,255,.06), rgba(230,193,90,.04));
      display:flex;align-items:center;justify-content:space-between;gap:10px;
    }
    .cardTitle{font-weight:820;font-size:13px}
    .cardBody{padding:12px}

    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .field{display:flex;flex-direction:column;gap:7px;flex:1}
    label{font-size:12px;color:var(--muted)}
    input[type="range"]{width:100%}

    .btn{
      border:none;cursor:pointer;
      padding:10px 10px;border-radius:12px;
      font-weight:780;font-size:12.5px;
      color:var(--text);
      background: rgba(82,230,255,.13);
      border:1px solid rgba(82,230,255,.24);
      transition: transform .05s ease, background .15s ease, border .15s ease;
      user-select:none;
    }
    .btn:hover{background: rgba(82,230,255,.17); border-color: rgba(82,230,255,.34)}
    .btn:active{transform: translateY(1px)}
    .btn.ghost{ background: rgba(0,0,0,.22); border-color: rgba(255,255,255,.14); }
    .btn.danger{ background: rgba(255,92,122,.14); border-color: rgba(255,92,122,.28); }
    .btn.small{padding:7px 9px;font-size:12px}

    .chip{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 10px;border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.20);
      color: rgba(255,255,255,.88);
      font-size:12px;
    }
    .dot{
      width:10px;height:10px;border-radius:999px;
      background: var(--cyan);
      box-shadow: 0 0 18px rgba(82,230,255,.35);
    }
    .dot.off{background: rgba(255,255,255,.18); box-shadow:none}

    .hint{font-size:12px;color:var(--muted);line-height:1.35;margin-top:8px}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;}
    .status{
      padding:10px;border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.22);
      font-size:12.5px;color: rgba(255,255,255,.88);
      line-height:1.35; word-break: break-word;
    }

    .stage{
      position:relative;min-height: 780px;padding:12px;
      background:
        radial-gradient(360px 260px at 50% 18%, rgba(255,255,255,.05), transparent 65%),
        linear-gradient(180deg, rgba(0,0,0,.10), rgba(0,0,0,.22));
    }
    .stageInner{
      position:absolute; inset:12px;
      border-radius:16px;border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.10);
      display:flex;align-items:center;justify-content:center;
      overflow:hidden;
    }
    svg{width:100%;height:100%;display:block}

    .base{
      fill: rgba(255,255,255,0.06);
      stroke: rgba(255,255,255,0.16);
      stroke-width:2.2;
      stroke-linejoin:round;
      stroke-linecap:round;
    }
    .muscle{
      fill: rgba(0,0,0,0);
      stroke: rgba(255,255,255,0.06);
      stroke-width:1.2;
      cursor:pointer;
      transition: fill .18s ease, filter .18s ease, opacity .18s ease;
    }
    .muscle:hover{filter: drop-shadow(0 0 10px rgba(82,230,255,.18))}
    .muscle.active{
      fill: var(--fill);
      filter: drop-shadow(0 0 14px rgba(230,193,90,.25));
    }
    .muscle.secondary{
      fill: var(--fill2);
      filter: drop-shadow(0 0 14px rgba(82,230,255,.22));
    }

    @media (max-width: 980px){
      .shell{grid-template-columns:1fr}
      .stage{min-height: 680px}
    }
  </style>
</head>

<body>
<header class="topbar">
  <div class="brand">
    <div class="logo" aria-hidden="true"></div>
    <div>
      <div class="title">Kintaro ‚Ä¢ Muscle Voice MVP</div>
      <div class="subtitle">Sag direkt den Muskel (Latein) ‚Üí wird markiert. (Optional: ‚Äûlinks/rechts‚Äú)</div>
    </div>
  </div>

  <div class="chip">
    <span class="dot off" id="micDot"></span>
    <span id="micLabel">Mic: Aus</span>
  </div>
</header>

<main class="shell">
  <aside class="card">
    <div class="cardHead">
      <div class="cardTitle">Voice</div>
      <button class="btn danger small" id="btnReset">Reset</button>
    </div>

    <div class="cardBody">
      <div class="row" style="margin-bottom:10px;">
        <button class="btn" id="btnMic">üéôÔ∏è Start Listening</button>
        <button class="btn ghost" id="btnStop">Stop</button>
      </div>

      <div class="field">
        <label>Markierungs-Intensit√§t</label>
        <input type="range" min="1" max="10" value="7" id="rngIntensity" />
        <div class="hint">Steuert die Deckkraft der Muskel-Markierung.</div>
      </div>

      <div class="hint" style="margin-top:12px">
        <b>Beispiele (Latein):</b><br>
        <span class="mono">biceps brachii</span> ‚Ä¢ <span class="mono">pectoralis major</span> ‚Ä¢ <span class="mono">rectus femoris</span><br>
        <span class="mono">tibialis anterior</span> ‚Ä¢ <span class="mono">gastrocnemius</span> ‚Ä¢ <span class="mono">sternocleidomastoideus</span><br>
        Optional: <span class="mono">links</span>/<span class="mono">rechts</span>
      </div>

      <div class="hint" style="margin-top:10px">
        Extra: <span class="mono">reset</span> / <span class="mono">alles aus</span> / <span class="mono">intensitaet 8</span>
      </div>

      <div class="status" id="status" style="margin-top:12px">
        Status: Bereit.
      </div>
    </div>
  </aside>

  <section class="card">
    <div class="cardHead">
      <div class="cardTitle">Front-Silhouette ‚Ä¢ 50 Muskeln (Overlay)</div>
      <div class="row">
        <span class="chip"><span class="dot"></span><span>Click / Voice</span></span>
      </div>
    </div>

    <div class="stage">
      <div class="stageInner">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 1000" role="img" aria-label="Human silhouette front with muscle overlays">
          <defs>
            <filter id="softEdge" x="-20%" y="-20%" width="140%" height="140%">
              <feGaussianBlur stdDeviation="1.2" result="b"/>
              <feColorMatrix in="b" type="matrix"
                values="1 0 0 0 0
                        0 1 0 0 0
                        0 0 1 0 0
                        0 0 0 .18 0" result="g"/>
              <feMerge>
                <feMergeNode in="g"/>
                <feMergeNode in="SourceGraphic"/>
              </feMerge>
            </filter>
          </defs>

          <g id="bodymap-front" filter="url(#softEdge)">
            <!-- Base silhouette -->
            <path class="base"
              d="M300 72
                 C268 72 247 92 244 121
                 C240 159 266 184 300 186
                 C334 184 360 159 356 121
                 C353 92 332 72 300 72 Z
                 M240 196
                 C220 210 210 235 211 265
                 C212 301 232 327 250 345
                 C244 360 240 378 240 400
                 C240 436 256 468 270 490
                 C260 505 254 522 252 548
                 C248 596 266 640 286 682
                 C294 699 296 715 292 730
                 C287 754 276 777 268 798
                 C262 814 262 832 274 846
                 C288 862 312 861 322 846
                 C330 835 330 819 324 802
                 C316 780 306 757 303 732
                 C301 718 304 701 312 682
                 C332 640 350 596 348 548
                 C347 522 340 505 330 490
                 C344 468 360 436 360 400
                 C360 378 356 360 350 345
                 C368 327 388 301 389 265
                 C390 235 380 210 360 196
                 C340 220 320 234 300 234
                 C280 234 260 220 240 196 Z
                 M210 280
                 C176 305 160 340 156 382
                 C152 430 168 474 198 508
                 C214 526 232 522 234 504
                 C238 470 238 438 236 404
                 C235 372 238 346 246 322
                 C252 304 236 268 210 280 Z
                 M390 280
                 C424 305 440 340 444 382
                 C448 430 432 474 402 508
                 C386 526 368 522 366 504
                 C362 470 362 438 364 404
                 C365 372 362 346 354 322
                 C348 304 364 268 390 280 Z"/>

            <!-- MUSCLE OVERLAYS (50 muscles = 25 pairs L/R) -->
            <g id="muscles">
              <!-- Helper: We approximate with ellipses/polygons for quick MVP positioning -->
              <!-- 1 Masseter -->
              <ellipse id="masseter_l" class="muscle" cx="282" cy="138" rx="16" ry="14" />
              <ellipse id="masseter_r" class="muscle" cx="318" cy="138" rx="16" ry="14" />

              <!-- 2 Temporalis -->
              <ellipse id="temporalis_l" class="muscle" cx="280" cy="112" rx="18" ry="16" />
              <ellipse id="temporalis_r" class="muscle" cx="320" cy="112" rx="18" ry="16" />

              <!-- 3 Sternocleidomastoideus -->
              <polygon id="sternocleidomastoideus_l" class="muscle" points="285,182 270,220 286,232 300,202"/>
              <polygon id="sternocleidomastoideus_r" class="muscle" points="315,182 300,202 314,232 330,220"/>

              <!-- 4 Deltoideus -->
              <ellipse id="deltoideus_l" class="muscle" cx="242" cy="258" rx="28" ry="24"/>
              <ellipse id="deltoideus_r" class="muscle" cx="358" cy="258" rx="28" ry="24"/>

              <!-- 5 Pectoralis major -->
              <ellipse id="pectoralis_major_l" class="muscle" cx="270" cy="310" rx="48" ry="32"/>
              <ellipse id="pectoralis_major_r" class="muscle" cx="330" cy="310" rx="48" ry="32"/>

              <!-- 6 Serratus anterior -->
              <polygon id="serratus_anterior_l" class="muscle" points="230,330 250,360 270,350 255,320"/>
              <polygon id="serratus_anterior_r" class="muscle" points="370,330 345,320 330,350 350,360"/>

              <!-- 7 Biceps brachii -->
              <ellipse id="biceps_brachii_l" class="muscle" cx="220" cy="320" rx="20" ry="30"/>
              <ellipse id="biceps_brachii_r" class="muscle" cx="380" cy="320" rx="20" ry="30"/>

              <!-- 8 Brachialis -->
              <ellipse id="brachialis_l" class="muscle" cx="235" cy="345" rx="16" ry="24"/>
              <ellipse id="brachialis_r" class="muscle" cx="365" cy="345" rx="16" ry="24"/>

              <!-- 9 Brachioradialis -->
              <ellipse id="brachioradialis_l" class="muscle" cx="212" cy="420" rx="18" ry="34"/>
              <ellipse id="brachioradialis_r" class="muscle" cx="388" cy="420" rx="18" ry="34"/>

              <!-- 10 Flexor carpi radialis -->
              <ellipse id="flexor_carpi_radialis_l" class="muscle" cx="224" cy="460" rx="14" ry="26"/>
              <ellipse id="flexor_carpi_radialis_r" class="muscle" cx="376" cy="460" rx="14" ry="26"/>

              <!-- 11 Palmaris longus -->
              <ellipse id="palmaris_longus_l" class="muscle" cx="235" cy="485" rx="12" ry="24"/>
              <ellipse id="palmaris_longus_r" class="muscle" cx="365" cy="485" rx="12" ry="24"/>

              <!-- 12 Thenar (eminentia thenaris) -->
              <ellipse id="eminentia_thenaris_l" class="muscle" cx="233" cy="552" rx="18" ry="14"/>
              <ellipse id="eminentia_thenaris_r" class="muscle" cx="367" cy="552" rx="18" ry="14"/>

              <!-- 13 Hypothenar (eminentia hypothenaris) -->
              <ellipse id="eminentia_hypothenaris_l" class="muscle" cx="220" cy="558" rx="18" ry="14"/>
              <ellipse id="eminentia_hypothenaris_r" class="muscle" cx="380" cy="558" rx="18" ry="14"/>

              <!-- 14 Rectus abdominis -->
              <ellipse id="rectus_abdominis_l" class="muscle" cx="285" cy="460" rx="24" ry="60"/>
              <ellipse id="rectus_abdominis_r" class="muscle" cx="315" cy="460" rx="24" ry="60"/>

              <!-- 15 Obliquus externus abdominis -->
              <polygon id="obliquus_externus_abdominis_l" class="muscle" points="250,420 270,540 285,520 270,410"/>
              <polygon id="obliquus_externus_abdominis_r" class="muscle" points="350,420 330,540 315,520 330,410"/>

              <!-- 16 Iliopsoas -->
              <ellipse id="iliopsoas_l" class="muscle" cx="285" cy="560" rx="18" ry="28"/>
              <ellipse id="iliopsoas_r" class="muscle" cx="315" cy="560" rx="18" ry="28"/>

              <!-- 17 Sartorius -->
              <polygon id="sartorius_l" class="muscle" points="275,640 250,760 265,770 292,650"/>
              <polygon id="sartorius_r" class="muscle" points="325,640 308,650 335,770 350,760"/>

              <!-- 18 Rectus femoris -->
              <ellipse id="rectus_femoris_l" class="muscle" cx="288" cy="720" rx="18" ry="60"/>
              <ellipse id="rectus_femoris_r" class="muscle" cx="312" cy="720" rx="18" ry="60"/>

              <!-- 19 Vastus lateralis -->
              <ellipse id="vastus_lateralis_l" class="muscle" cx="270" cy="730" rx="22" ry="62"/>
              <ellipse id="vastus_lateralis_r" class="muscle" cx="330" cy="730" rx="22" ry="62"/>

              <!-- 20 Vastus medialis -->
              <ellipse id="vastus_medialis_l" class="muscle" cx="295" cy="770" rx="18" ry="40"/>
              <ellipse id="vastus_medialis_r" class="muscle" cx="305" cy="770" rx="18" ry="40"/>

              <!-- 21 Adductor longus -->
              <ellipse id="adductor_longus_l" class="muscle" cx="287" cy="700" rx="14" ry="44"/>
              <ellipse id="adductor_longus_r" class="muscle" cx="313" cy="700" rx="14" ry="44"/>

              <!-- 22 Gracilis -->
              <polygon id="gracilis_l" class="muscle" points="295,660 280,820 292,828 308,668"/>
              <polygon id="gracilis_r" class="muscle" points="305,660 292,668 308,828 320,820"/>

              <!-- 23 Tibialis anterior -->
                           <ellipse id="vastus_medialis_l" class="muscle" cx="295" cy="770" rx="18" ry="40"/>
              <ellipse id="vastus_medialis_r" class="muscle" cx="305" cy="770" rx="18" ry="40"/>

            </g> <!-- /muscles -->
          </g> <!-- /bodymap-front -->
        </svg>
      </div>
    </div>
  </section>
</main>

<script>
  /* ===============================
     HELPERS
  =============================== */
  const $ = (id) => document.getElementById(id);
  const statusEl = $("status");
  const rngIntensity = $("rngIntensity");
  const micDot = $("micDot");
  const micLabel = $("micLabel");

  function setStatus(txt){
    statusEl.innerHTML = "Status: " + txt;
  }

  function normalize(s){
    return (s||"")
      .toLowerCase()
      .replace(/[√§]/g,"ae").replace(/[√∂]/g,"oe").replace(/[√º]/g,"ue").replace(/√ü/g,"ss")
      .replace(/[^a-z0-9\s]/g," ")
      .replace(/\s+/g," ")
      .trim();
  }

  /* ===============================
     INTENSITY
  =============================== */
  function setFillByIntensity(n){
    const a = 0.22 + (n-1) * (0.7/9);
    document.documentElement.style.setProperty(
      "--fill", `rgba(230,193,90,${a.toFixed(2)})`
    );
  }
  setFillByIntensity(parseInt(rngIntensity.value,10));
  rngIntensity.addEventListener("input", e=>{
    setFillByIntensity(parseInt(e.target.value,10));
  });

  /* ===============================
     MUSCLE HANDLING
  =============================== */
  const svg = document.querySelector("svg");
  const muscles = () => [...svg.querySelectorAll(".muscle")];

  function clearAll(){
    muscles().forEach(m => m.classList.remove("active","secondary"));
  }

  function activate(id, secondary=false){
    const el = svg.getElementById(id);
    if(!el) return false;
    el.classList.add(secondary ? "secondary" : "active");
    return true;
  }

  svg.addEventListener("click", e=>{
    if(!e.target.classList.contains("muscle")) return;
    e.target.classList.toggle("active");
    setStatus(`<b>${e.target.id}</b> geklickt`);
  });

  /* ===============================
     MUSCLE DICTIONARY (1‚Äì20)
  =============================== */
  const MUSCLES = [
    ["masseter","masseter"],
    ["temporalis","temporalis"],
    ["sternocleidomastoideus","sternocleidomastoideus","scm"],
    ["deltoideus","deltoideus"],
    ["pectoralis major","pectoralis_major"],
    ["serratus anterior","serratus_anterior"],
    ["biceps brachii","biceps_brachii","biceps"],
    ["brachialis","brachialis"],
    ["brachioradialis","brachioradialis"],
    ["flexor carpi radialis","flexor_carpi_radialis"],
    ["palmaris longus","palmaris_longus"],
    ["eminentia thenaris","eminentia_thenaris"],
    ["eminentia hypothenaris","eminentia_hypothenaris"],
    ["rectus abdominis","rectus_abdominis"],
    ["obliquus externus abdominis","obliquus_externus_abdominis"],
    ["iliopsoas","iliopsoas"],
    ["sartorius","sartorius"],
    ["rectus femoris","rectus_femoris"],
    ["vastus lateralis","vastus_lateralis"],
    ["vastus medialis","vastus_medialis"]
  ];

  const lookup = new Map();
  MUSCLES.forEach(([latin,key,...aliases])=>{
    lookup.set(normalize(latin),key);
    aliases.forEach(a=>lookup.set(normalize(a),key));
  });

  function detectSide(t){
    if(/\b(rechts|right|dexter)\b/.test(t)) return "r";
    if(/\b(links|left|sinister)\b/.test(t)) return "l";
    return null;
  }

  function matchMuscle(t){
    if(lookup.has(t)) return lookup.get(t);
    for(const k of lookup.keys()){
      if(t.includes(k)) return lookup.get(k);
    }
    return null;
  }

  /* ===============================
     VOICE
  =============================== */
  let recognition;
  let listening = false;

  function startListening(){
    const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
    if(!SR){
      setStatus("SpeechRecognition nicht verf√ºgbar (Chrome nutzen).");
      return;
    }
    recognition = new SR();
    recognition.lang = "de-DE";
    recognition.continuous = true;

    recognition.onstart = ()=>{
      listening = true;
      micDot.classList.remove("off");
      micLabel.textContent = "Mic: An";
      setStatus("Listening‚Ä¶ sag einen Muskel (Latein).");
    };

    recognition.onresult = (e)=>{
      const txt = normalize(e.results[e.results.length-1][0].transcript);
      const side = detectSide(txt);
      const base = matchMuscle(txt);

      if(!base){
        setStatus(`Nicht erkannt: <span class="mono">${txt}</span>`);
        return;
      }

      clearAll();

      if(side==="l"){ activate(base+"_l"); }
      else if(side==="r"){ activate(base+"_r"); }
      else{
        activate(base+"_l");
        activate(base+"_r",true);
      }

      setStatus(`Muskel markiert: <b>${base}</b>`);
    };

    recognition.start();
  }

  function stopListening(){
    if(recognition){
      recognition.stop();
      recognition = null;
    }
    listening = false;
    micDot.classList.add("off");
    micLabel.textContent = "Mic: Aus";
    setStatus("Mic gestoppt.");
  }

  $("btnMic").onclick = startListening;
  $("btnStop").onclick = stopListening;
  $("btnReset").onclick = ()=>{ clearAll(); setStatus("Reset."); };

  setStatus("Bereit. Starte Mic.");
</script>

</body>
</html>